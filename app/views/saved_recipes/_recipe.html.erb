<div class="recipe-info container">
  <h2 class="recipe-name"><%= recipe.name %></h2>
  <% if recipe.web_image %>
    <img src=<%= recipe.web_image %> alt="Soup image" width="200" height="200">
  <% else %>
    <img src=<%= recipe.image %> alt="Soup image" width="200" height="200">
  <% end %>
  
  <% if @avg_rating %>
    <h2>Average Rating: <%= @avg_rating %>/5</h2>
  <% else %>
    <h2>Average Rating: There are no ratings yet!</h2>
  <% end %>

  <h2>Ingredients:</h2>
  <ul>
    <% recipe.ingredients.each do |ingredient| %>
      <li class="ingredients-list"><%= ingredient.item %></li>
    <% end %>
  </ul>


  <h2>Cooking Instructions:</h2>
  <% if recipe.directions %>
    <h5><%= recipe.directions %></h5>
  <% else %>
    <h5>Find recipe by clicking <%= link_to "HERE!", "#{recipe.recipe_url}", target: '_blank' %></h5>
  <% end %>

  <% if current_user %>
    <h2>Reviews and Comments:</h2>
    <%= form_for [recipe, Review.new] do |form| %>
      <div class="form-group">
        <%= form.label :Write_a_review! %>
        <%= form.text_area :comment %>
      </div>

      <div class="form-group">
        <%= form.label :rating %>
        <%= form.select :rating, [5, 4, 3, 2, 1] %>
      </div>

      <%= form.submit 'Post', class: 'btn btn-primary' %>
    <% end %>
  <% end %>

  <div class="reviews">
    <% recipe.reviews.reverse_each do |review| %>
      <div class="review-details">
        <% if review.rating %>
          <h5>Posted by: <%= review.user.first_name %> <%= review.user.last_name %></h5>
          <p>Rating: <%= review.rating %>/5</p>
          <p>Comments: <%= review.comment %></p>
        <% end %>

        <% if current_user && current_user.id == review.user_id %>
          <%= link_to edit_recipe_review_path(recipe_id: recipe.id, id: review.id) do %>
            <%= fa_icon "edit", text: 'Edit', class: 'fa-icon green' %>
          <% end %>
            |
          <%= link_to recipe_review_path(recipe_id: recipe.id, id: review.id),
            method: :delete,
            data: { confirm: "Delete this review?" } do %>
              <%= fa_icon "trash", text: 'Delete', class: 'fa-icon red' %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
